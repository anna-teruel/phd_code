colour = NA
),
panel.border = element_rect(
fill = NA,
colour = "grey50"
),
panel.grid.major = element_line(
colour = "grey90",
size = 0.2
),
panel.grid.minor = element_line(
colour = "grey98",
size = 0.5
),
strip.background = element_rect(
fill = "grey80",
colour = "grey50"
),
legend.text = element_text(size = 11),
strip.text.x = element_text(size = 9),
strip.text.y = element_text(size = 9)
)
# plot data
ggplot(df.subset.melt) +
geom_point(aes(x = condition, value, color = sex), data = df.subset.melt) +
prop_biomass_theme
# plot data
ggplot(df.subset.melt) +
geom_point(aes(x = condition, value, color = sex), data = df.subset.melt) +
facet_grid(condition ~ variable, scales = "free_y") +
prop_biomass_theme +
ylab("Proportion biomass") +
labs(color = "N supply")
# plot data
ggplot(df.subset.melt) +
geom_point(aes(x = sex, value, color = condition), data = df.subset.melt) +
facet_grid(condition ~ variable, scales = "free_y") +
prop_biomass_theme +
ylab("Proportion biomass") +
labs(color = "N supply")
# plot data
ggplot(df.subset.melt) +
geom_point(aes(x = sex, value, color = condition), data = df.subset.melt) +
prop_biomass_theme +
ylab("Proportion in arms") +
labs(color = "N supply")
library(betareg)
library(plyr)
library(lmtest)
library(glmmTMB)
library(boot)
library(emmeans)
library(brms)
library(ggplot2)
library(mvtnorm)
library(nlme)
library(rstan)
install.packages("brms")
install.packages("rstan")
andrew <- read.csv("data/andrew.csv", colClasses = c(QUAD = "factor", PATCH = "factor"))
summary(andrew)
library(betareg)
library(plyr)
library(lmtest)
library(glmmTMB)
library(boot)
library(emmeans)
library(brms)
library(ggplot2)
library(mvtnorm)
library(nlme)
library(rstan)
install.packages("rstan")
library(betareg)
library(plyr)
library(lmtest)
library(glmmTMB)
library(boot)
library(emmeans)
library(brms)
library(ggplot2)
library(mvtnorm)
library(nlme)
library(rstan)
install.packages("glmmTMB")
library(betareg)
library(plyr)
library(lmtest)
library(glmmTMB)
library(boot)
library(emmeans)
library(brms)
library(ggplot2)
library(mvtnorm)
library(nlme)
library(rstan)
install.packages("brms")
library(readxl)
library(ggplot2)
library(ggpubr)
library(car)
library(multcomp)
library(pastecs)
library(compute.es)
library(MVN)
library(ez)
library(nlme)
library(reshape)
library(WRS2)
library(lmerTest)
library(effsize)
library(hrbrthemes)
library(viridis)
library(emmeans)
library(lme4)
library(DirichletReg)
library(lmtest)
library(reshape)
library(ggplot2)
library(ggtern)
setwd("/Users/annateruel/Desktop/analisi_FINAL/epm/")
df <- read.table('epm-results.csv',sep=';', dec = ',',heaYder=TRUE)
setwd("/Users/annateruel/Desktop/analisi_FINAL/epm/")
df <- read.table('epm-results.csv',sep=';', dec = ',')
df$animal <- factor(df$animal)
View(df)
setwd("/Users/annateruel/Desktop/analisi_FINAL/epm/")
df <- read.table('epm-results.csv',sep=';', dec = ',', heaYder)
setwd("/Users/annateruel/Desktop/analisi_FINAL/epm/")
df <- read.table('epm-results.csv',sep=';', dec = ',', header=TRUE)
df$animal <- factor(df$animal)
df$condition <- factor(df$condition, levels = c("naive", "ms"))
df$sex <- factor(df$sex)
df <- df[df$software %in% c("DLC"), ]
# melt data for explorative plotting
df.subset <- df[, c(1:4, 11:12)]
# melt data.frame with first four columns as id variables
df.subset.melt <- melt(df.subset, id.var = 1:4)
View(df.subset.melt)
head(ArcticLake)
AL <- DR_data(ArcticLake[, 1:3])
library(readxl)
library(ggplot2)
library(ggpubr)
library(car)
library(multcomp)
library(pastecs)
library(compute.es)
library(MVN)
library(ez)
library(nlme)
library(reshape)
library(WRS2)
library(lmerTest)
library(effsize)
library(hrbrthemes)
library(viridis)
library(emmeans)
library(lme4)
library(pca3d)
library(pca3d)
library(readxl)
library(ggplot2)
library(ggpubr)
library(car)
library(multcomp)
library(pastecs)
library(compute.es)
library(MVN)
library(ez)
library(nlme)
library(reshape)
library(WRS2)
library(lmerTest)
library(effsize)
library(hrbrthemes)
library(viridis)
library(emmeans)
library(lme4)
library(pca3d)
library(pca3d)
install.packages("rgl")
install.packages("rgl")
install.packages("rgl")
library(readxl)
library(ggplot2)
library(ggpubr)
library(car)
library(multcomp)
library(pastecs)
library(compute.es)
library(MVN)
library(ez)
library(nlme)
library(reshape)
library(WRS2)
library(lmerTest)
library(effsize)
library(hrbrthemes)
library(viridis)
library(emmeans)
library(lme4)
library(pca3d)
install.packages("htmlwidgets")
library(readxl)
library(ggplot2)
library(ggpubr)
library(car)
library(multcomp)
library(pastecs)
library(compute.es)
library(MVN)
library(ez)
library(nlme)
library(reshape)
library(WRS2)
library(lmerTest)
library(effsize)
library(hrbrthemes)
library(viridis)
library(emmeans)
library(lme4)
library(pca3d)
install.packages("OpenGL")
library(pca3d)
library(pca3d)
library(factoextra)
library(ggplot2)
library(readxl)
library(FactoMineR)
library(ggradar)
library(tidyr)
pca <- read_excel("/Users/annateruel/Desktop/analisi_FINAL/epm/pca.xlsx")
fos_pca = prcomp(df[,-1], scale = TRUE)
library(pca3d)
library(factoextra)
library(ggplot2)
library(readxl)
library(FactoMineR)
library(ggradar)
library(tidyr)
pca <- read_excel("/Users/annateruel/Desktop/analisi_FINAL/epm/pca.xlsx")
View(pca)
fos_pca = prcomp(df[,-1], scale = TRUE)
df <- read_excel("/Volumes/HDAnna/DOCTORAT/ANALYSIS/EXPERIMENTS/2021/orina-citralva-histologia-04-2021/paper_cfos/cfos-orinacitralva-def2.0.xlsx")
#PCA
fos_pca2 = prcomp(df[,-1], scale = TRUE)
View(df)
View(fos_pca2)
fos_pca = prcomp(pca[,-1], scale = TRUE)
pca <- read_excel("/Users/annateruel/Desktop/analisi_FINAL/epm/pca.xlsx")
fos_pca = prcomp(pca[,-1], scale = TRUE)
fviz_pca_biplot(fos_pca, repel = TRUE,
col.var = "contrib", gradient.cols = c("#fcae12", "#f98e09", "#bc3754", "#57106e"),
col.ind = "#696969") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
fviz_pca_biplot(fos_pca, repel = TRUE,
col.var = "contrib", gradient.cols = c("#fcae12", "#f98e09", "#bc3754", "#57106e"),
col.ind = "#696969") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
View(pca)
pca <- read_excel("/Users/annateruel/Desktop/analisi_FINAL/epm/pca.xlsx")
fos_pca = prcomp(pca[,-1], scale = TRUE)
fviz_pca_biplot(fos_pca, repel = TRUE,
col.var = "contrib", gradient.cols = c("#fcae12", "#f98e09", "#bc3754", "#57106e"),
col.ind = "#696969") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
fviz_pca_biplot(fos_pca, repel = TRUE,
col.var = "contrib", gradient.cols = c("#fcae12", "#f98e09", "#bc3754", "#57106e"),
col.ind = "#696969") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
fviz_pca_biplot(fos_pca, repel = TRUE,habillage=pca$Grup,
col.var = "contrib", gradient.cols = c("#fcae12", "#f98e09", "#bc3754", "#57106e"),
col.ind = "#696969") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
fviz_pca_ind(fos_pca, label="none", habillage=pca$Grup)
fviz_pca_ind(fos_pca, label="none", habillage=pca$Grup, addEllipses=TRUE, ellipse.level=0.95))
fviz_pca_ind(fos_pca, label="none", habillage=pca$Grup, addEllipses=TRUE, ellipse.level=0.95)
pca <- read_excel("/Users/annateruel/Desktop/analisi_FINAL/epm/pca.xlsx")
fos_pca = prcomp(pca[,-1], scale = TRUE)
fos_pca = prcomp(pca[,-1], scale = TRUE)
fviz_pca_biplot(fos_pca, repel = TRUE,
col.var = "contrib", gradient.cols = c("#fcae12", "#f98e09", "#bc3754", "#57106e"),
col.ind = "#696969") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
fviz_pca_ind(fos_pca, label="none", habillage=pca$Grup, addEllipses=TRUE, ellipse.level=0.95)
pca <- read_excel("/Users/annateruel/Desktop/analisi_FINAL/epm/pca_oa.xlsx")
fos_pca = prcomp(pca[,-1], scale = TRUE)
fviz_pca_ind(fos_pca, label="none", habillage=pca$Grup, addEllipses=TRUE, ellipse.level=0.95)
View(fos_pca)
View(pca)
pca <- read_excel("/Users/annateruel/Desktop/analisi_FINAL/epm/pca_oa.xlsx")
fos_pca = prcomp(pca[,-1], scale = TRUE)
library(readxl)
library(ggplot2)
library(ggpubr)
library(car)
library(multcomp)
library(pastecs)
library(compute.es)
library(MVN)
library(ez)
library(nlme)
library(reshape)
library(WRS2)
library(lmerTest)
library(effsize)
library(hrbrthemes)
library(viridis)
library(emmeans)
library(lme4)
setwd("/Users/annateruel/Desktop/analisi_FINAL/epm/")
df <- read.table('epm-results.csv',sep=';', dec = ',',header=TRUE)
setwd("/Users/annateruel/Desktop/analisi_FINAL/epm/")
df <- read.table('epm-results.csv',sep=';', dec = ',',header=TRUE)
df$animal <- factor(df$animal)
df$condition <- factor(df$condition, levels = c("naive", "ms"))
df$sex <- factor(df$sex)
df.dlc <- df[df$software %in% c("DLC"), ]
df.smart <- df[df$software %in% c("SMART"), ]
LMM.1 <- lm(oa_ln ~ sex*condition, data = df.dlc)
LMM.2 <- lm(oa_ln ~ sex+condition, data = df.dlc)
anova(LMM.1, LMM.2)
summary(LMM.2)
anova(LMM.2)
ggplot(data = df.dlc, aes(x=sex, y=oa_ln , group=condition,  fill=condition, color= condition)) +
geom_jitter(shape=16, position=position_jitterdodge(), size=3, aes(group=condition))+
stat_summary(fun = mean, geom = "bar", position="dodge2", alpha=0, size=1) +
stat_summary(fun.data = mean_se, geom = "errorbar", color="#404040", position = position_dodge(width = 0.90), width = 0.2) +
scale_color_manual(values = c("#A6A6A6",
"#D93D04")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
by(df.dlc$oa_ln, list(df.dlc$condition, df.dlc$sex), shapiro.test) #normalidad
leveneTest(oa_ln ~ condition*sex, data = df.dlc) #homogeneidad varianzas
LMM.1 <- lm(ca_ln ~ sex*condition, data = df.dlc)
LMM.2 <- lm(ca_ln ~ sex+condition, data = df.dlc)
anova(LMM.1, LMM.2)
summary(LMM.1)
anova(LMM.1)
ggplot(data = df.dlc, aes(x=sex, y=ca_ln , group=condition,  fill=condition, color= condition)) +
geom_jitter(shape=16, position=position_jitterdodge(), size=3, aes(group=condition))+
stat_summary(fun = mean, geom = "bar", position="dodge2", alpha=0, size=1) +
stat_summary(fun.data = mean_se, geom = "errorbar", color="#404040", position = position_dodge(width = 0.90), width = 0.2) +
scale_color_manual(values = c("#A6A6A6",
"#D93D04")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
library(readxl)
library(ggplot2)
library(ggpubr)
library(car)
library(multcomp)
library(pastecs)
library(compute.es)
library(MVN)
library(ez)
library(nlme)
library(reshape)
library(WRS2)
library(lmerTest)
library(effsize)
library(hrbrthemes)
library(viridis)
library(emmeans)
library(lme4)
library(tidyr)
setwd("/Users/annateruel/Desktop/analisi_FINAL/TU")
df <- read.table('dcx_ki67_Tu2.csv',sep=';', dec = ',',header=TRUE)
setwd("/Users/annateruel/Desktop/analisi_FINAL/TU")
df <- read.table('dcx_ki67_SUMA.csv',sep=';', dec = ',',header=TRUE)
df$animal <- factor(df$animal)
df$condicion <- factor(df$cond, levels = c("naive", "ms"))
df$sexe <- factor(df$sexe)
ggplot(data = df, aes(x=sexe, y=DCX , group=condicion,  fill=condicion, color= condicion)) +
geom_jitter(shape=16, position=position_jitterdodge(), size=3, aes(group=condicion))+
stat_summary(fun = mean, geom = "bar", position="dodge2", alpha=0, size=1) +
scale_color_manual(values=c("#B876E3", "#F5BF60"))+
stat_summary(fun.data = mean_se, geom = "errorbar", color="#404040", position = position_dodge(width = 0.90), width = 0.2) +
scale_color_manual(values = c("#A6A6A6",
"#D93D04")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
LMM.1 <- lm(DCX ~ sexe*condicion, data = df)
anova(LMM.1)
by(df$DCX, list(df$sexe, df$condicion), stat.desc, basic = FALSE)
ggplot(data = df, aes(x=sexe, y=DCX , group=condicion,  fill=condicion, color= condicion)) +
geom_jitter(shape=16, position=position_jitterdodge(), size=3, aes(group=condicion))+
stat_summary(fun = mean, geom = "bar", position="dodge2", alpha=0, size=1) +
scale_color_manual(values=c("#B876E3", "#F5BF60"))+
stat_summary(fun.data = mean_se, geom = "errorbar", color="#404040", position = position_dodge(width = 0.90), width = 0.2) +
scale_color_manual(values = c("#A6A6A6",
"#D93D04")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
View(df)
View(df)
setwd("/Users/annateruel/Desktop/analisi_FINAL/TU")
df <- read.table('dcx_ki67_SUMA.csv',sep=';', dec = ',',header=TRUE)
setwd("/Users/annateruel/Desktop/analisi_FINAL/TU")
df <- read.table('dcx_ki67_SUMA.csv',sep=';', dec = ',',header=TRUE)
df$animal <- factor(df$animal)
df$condicion <- factor(df$cond, levels = c("naive", "ms"))
df$sexe <- factor(df$sexe)
by(df$DCX, list(df$sexe, df$condicion), stat.desc, basic = FALSE)
LMM.1 <- lm(DCX ~ sexe*condicion, data = df)
anova(LMM.1)
ggplot(data = df, aes(x=sexe, y=DCX , group=condicion,  fill=condicion, color= condicion)) +
geom_jitter(shape=16, position=position_jitterdodge(), size=3, aes(group=condicion))+
stat_summary(fun = mean, geom = "bar", position="dodge2", alpha=0, size=1) +
scale_color_manual(values=c("#B876E3", "#F5BF60"))+
stat_summary(fun.data = mean_se, geom = "errorbar", color="#404040", position = position_dodge(width = 0.90), width = 0.2) +
scale_color_manual(values = c("#A6A6A6",
"#D93D04")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
strip.text = element_text(size= 14))
library(readxl)
library(ggplot2)
library(ggpubr)
library(car)
library(multcomp)
library(pastecs)
library(compute.es)
library(MVN)
library(ez)
library(nlme)
library(pastecs)
library(reshape)
library(WRS2)
library(lmerTest)
library(effsize)
library(tidyverse)
library(hrbrthemes)
library(viridis)
library(emmeans)
library(lme4)
library(mvnormtest)
library(dplyr)
library(tidyr)
setwd('/Volumes/ANNA_HD/ANALYSIS/QUINT/output/abeta_extra/')
df2 <- read.table('results_abeta_extra_2.csv',sep=';', dec = ',',header=TRUE)
df2 <- gather(df2, key="brain_area", value = "cells", 3:9, -animal, -age)
df2$age <- factor(df2$age, levels = c("3", "6", "9", "12"))
LMM.1 <- glm(cells ~ age*brain_area, data = df2, family = "poisson")
Anova(LMM.1, type='III')
lsmeans(LMM.1, pairwise~ age*brain_area, adjust="tukey")
lsmeans(LMM.1, pairwise~ age, adjust="tukey")
LMM.2 <- lm(cells ~ age*brain_area, data = df2)
anova(LMM.2)
lsmeans(LMM.2, pairwise~ age*, adjust="tukey")
lsmeans(LMM.2, pairwise~ age, adjust="tukey")
